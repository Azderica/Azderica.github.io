{"hash":"2858839cb272bd8e3f388ae3dd5d59774a4a3863","data":{"post":{"title":"[SpringBoot API] SpringBoot REST API : HATEOAS와 Self-Describtive Message 적용","path":"/03-springboot-restapi/","date":"14. September 2020","timeToRead":5,"tags":[{"id":"Spring","title":"Spring","path":"/tag/Spring/"},{"id":"SpringBoot","title":"SpringBoot","path":"/tag/SpringBoot/"},{"id":"SpringBoot API","title":"SpringBoot API","path":"/tag/SpringBoot%20API/"},{"id":"REST API","title":"REST API","path":"/tag/REST%20API/"},{"id":"Backend","title":"Backend","path":"/tag/Backend/"}],"description":" 'SpringBoot REST API'의 세번째 게시글입니다. ","content":"<h1 id=\"hateoas와-self-describtive-message\"><a href=\"#hateoas%EC%99%80-self-describtive-message\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>HATEOAS와 Self-Describtive Message</h1>\n<br/>\n<h2 id=\"스프링-hateoas-소개\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-hateoas-%EC%86%8C%EA%B0%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 HATEOAS 소개</h2>\n<h3 id=\"스프링-hateoas\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-hateoas\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 HATEOAS</h3>\n<ul>\n<li><a href=\"https://docs.spring.io/spring-hateoas/docs/current/reference/html/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.spring.io/spring-hateoas/docs/current/reference/html/</a></li>\n<li>\n<p>링크 만드는 기능</p>\n<ul>\n<li>문자열 가지고 만들기</li>\n<li>컨트롤러와 메소드로 만들기</li>\n</ul>\n</li>\n<li>\n<p>리소스 만드는 기능</p>\n<ul>\n<li>리소스: 데이터 + 링크</li>\n</ul>\n</li>\n<li>\n<p>링크 찾아주는 기능</p>\n<ul>\n<li>Traverson</li>\n<li>LinkDiscoverers</li>\n</ul>\n</li>\n<li>\n<p>링크</p>\n<ul>\n<li>HREF</li>\n<li>\n<p>REL</p>\n<ul>\n<li>self</li>\n<li>profile</li>\n<li>update-event</li>\n<li>query-events</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<img src=\"https://user-images.githubusercontent.com/42582516/93029741-704ef880-f658-11ea-8e27-81d626a05ed8.png\" alt=\"image\" style=\"zoom:30%;\" />\n<br/>\n<h2 id=\"스프링-hateoas-적용\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-hateoas-%EC%A0%81%EC%9A%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 HATEOAS 적용</h2>\n<h3 id=\"evnetresource-만들기\"><a href=\"#evnetresource-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>EvnetResource 만들기</h3>\n<ul>\n<li>\n<p>extends ResourceSupport의 문제</p>\n<ul>\n<li>@JsonUnwrapped로 해결</li>\n<li>extends Resource<T>로 해결</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"테스트-할-것\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%A0-%EA%B2%83\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>테스트 할 것</h3>\n<ul>\n<li>\n<p>응답에 HATEOA와 profile 관련 링크가 있는지 확인.</p>\n<ul>\n<li>self (view)</li>\n<li>update (만든 사람은 수정할 수 있으니까)</li>\n<li>events (목록으로 가는 링크)</li>\n</ul>\n</li>\n</ul>\n<br/>\n<h2 id=\"스프링-rest-docs-소개\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-rest-docs-%EC%86%8C%EA%B0%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 REST Docs 소개</h2>\n<p><a href=\"https://docs.spring.io/spring-restdocs/docs/2.0.2.RELEASE/reference/html5/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.spring.io/spring-restdocs/docs/2.0.2.RELEASE/reference/html5/</a></p>\n<h3 id=\"rest-docs-코딩\"><a href=\"#rest-docs-%EC%BD%94%EB%94%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>REST Docs 코딩</h3>\n<ul>\n<li>andDo(document(“doc-name”, snippets))</li>\n<li>\n<p>snippets</p>\n<ul>\n<li>links()</li>\n<li>requestParameters() + parameterWithName()</li>\n<li>pathParameters() + parametersWithName()</li>\n<li>requestParts() + partWithname()</li>\n<li>requestPartBody()</li>\n<li>requestPartFields()</li>\n<li>requestHeaders() + headerWithName()</li>\n<li>requestFields() + fieldWithPath()</li>\n<li>responseHeaders() + headerWithName()</li>\n<li>responseFields() + fieldWithPath()</li>\n<li>...</li>\n</ul>\n</li>\n<li>Relaxed*</li>\n<li>\n<p>Processor</p>\n<ul>\n<li>preprocessRequest(prettyPrint())</li>\n<li>preprocessResponse(prettyPrint())</li>\n<li>...</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"constraint\"><a href=\"#constraint\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Constraint</h3>\n<p><a href=\"https://github.com/spring-projects/spring-restdocs/blob/v2.0.2.RELEASE/samples/rest-notes-spring-hateoas/src/test/java/com/example/notes/ApiDocumentation.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/spring-projects/spring-restdocs/blob/v2.0.2.RELEASE/samples/rest-notes-spring-hateoas/src/test/java/com/example/notes/ApiDocumentation.java</a></p>\n<br/>\n<h2 id=\"스프링-rest-docs-적용\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-rest-docs-%EC%A0%81%EC%9A%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 REST Docs 적용</h2>\n<h3 id=\"rest-docs-자동-설정\"><a href=\"#rest-docs-%EC%9E%90%EB%8F%99-%EC%84%A4%EC%A0%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>REST Docs 자동 설정</h3>\n<ul>\n<li>@AutoConfigureRestDocs</li>\n</ul>\n<h3 id=\"restdocmockmvc-커스터마이징\"><a href=\"#restdocmockmvc-%EC%BB%A4%EC%8A%A4%ED%84%B0%EB%A7%88%EC%9D%B4%EC%A7%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>RestDocMockMvc 커스터마이징</h3>\n<ul>\n<li>RestDocsMockMvcConfigurationCustomizer 구현한 빈 등록</li>\n<li>@TestConfiguration</li>\n</ul>\n<h3 id=\"테스트-할-것-1\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%A0-%EA%B2%83-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>테스트 할 것</h3>\n<ul>\n<li>\n<p>API 문서 만들기</p>\n<ul>\n<li>요청 본문 문서화</li>\n<li>응답 본문 문서화</li>\n<li>\n<p>링크 문서화</p>\n<ul>\n<li>profile 링크 추가</li>\n</ul>\n</li>\n<li>응답 헤더 문서화</li>\n</ul>\n</li>\n</ul>\n<br/>\n<h2 id=\"스프링-rest-docs-링크-req-res-필드와-헤더-문서화\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-rest-docs-%EB%A7%81%ED%81%AC-req-res-%ED%95%84%EB%93%9C%EC%99%80-%ED%97%A4%EB%8D%94-%EB%AC%B8%EC%84%9C%ED%99%94\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 REST Docs: 링크, (Req, Res) 필드와 헤더 문서화</h2>\n<h3 id=\"요청-필드-문서화\"><a href=\"#%EC%9A%94%EC%B2%AD-%ED%95%84%EB%93%9C-%EB%AC%B8%EC%84%9C%ED%99%94\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>요청 필드 문서화</h3>\n<ul>\n<li>requestFields() + fieldWithPath()</li>\n<li>responseFields() + fieldWithPath()</li>\n<li>requestHeaders() + headerWithName()</li>\n<li>responseHedaers() + headerWithName()</li>\n<li>links() + linkWithRel()</li>\n</ul>\n<h3 id=\"테스트-할-것-2\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%A0-%EA%B2%83-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>테스트 할 것</h3>\n<ul>\n<li>\n<p>API 문서 만들기</p>\n<ul>\n<li>요청 본문 문서화</li>\n<li>응답 본문 문서화</li>\n<li>\n<p>링크 문서화</p>\n<ul>\n<li>self</li>\n<li>query-events</li>\n<li>update-event</li>\n<li>profile 링크 추가</li>\n</ul>\n</li>\n<li>요청 헤더 문서화</li>\n<li>요청 필드 문서화</li>\n<li>응답 헤더 문서화</li>\n<li>응답 필드 문서화</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"relaxed-접두어\"><a href=\"#relaxed-%EC%A0%91%EB%91%90%EC%96%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Relaxed 접두어</h3>\n<ul>\n<li>장점: 문서 일부분만 테스트 할 수 있다.</li>\n<li>단점: 정확한 문서를 생성하지 못한다.</li>\n</ul>\n<br/>\n<h2 id=\"스프링-rest-docs-문서-빌드\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-rest-docs-%EB%AC%B8%EC%84%9C-%EB%B9%8C%EB%93%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 REST Docs 문서 빌드</h2>\n<h3 id=\"스프링-rest-docs\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-rest-docs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>스프링 REST Docs</h3>\n<ul>\n<li><a href=\"https://docs.spring.io/spring-restdocs/docs/2.0.2.RELEASE/reference/html5/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.spring.io/spring-restdocs/docs/2.0.2.RELEASE/reference/html5/</a></li>\n<li>pom.xml에 메이븐 플러그인 설정</li>\n</ul>\n<pre class=\"language-xml\"><code class=\"language-xml\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.asciidoctor<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>asciidoctor-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.5.3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>executions</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>generate-docs<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>phase</span><span class=\"token punctuation\">></span></span>prepare-package<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>phase</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>process-asciidoc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>backend</span><span class=\"token punctuation\">></span></span>html<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>backend</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>doctype</span><span class=\"token punctuation\">></span></span>book<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>doctype</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>executions</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.restdocs<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-restdocs-asciidoctor<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.0.2.RELEASE<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>maven-resources-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>executions</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>copy-resources<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>phase</span><span class=\"token punctuation\">></span></span>prepare-package<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>phase</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>copy-resources<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>outputDirectory</span><span class=\"token punctuation\">></span></span>\n                                ${project.build.outputDirectory}/static/docs\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>outputDirectory</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span>\n                                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span>\n                                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>\n                                        ${project.build.directory}/generated-docs\n                                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span>\n                                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>executions</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code></pre>\n<ul>\n<li>\n<p>템플릿 파일 추가</p>\n<ul>\n<li>src/main/asciidoc/index.adoc</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"문서-생성하기\"><a href=\"#%EB%AC%B8%EC%84%9C-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>문서 생성하기</h3>\n<ul>\n<li>\n<p>mvn package</p>\n<ul>\n<li>test</li>\n<li>prepare-package :: process-asciidoc</li>\n<li>prepare-package :: copy-resources</li>\n</ul>\n</li>\n<li>\n<p>문서 확인</p>\n<ul>\n<li>/docs/index.html</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"테스트-할-것-3\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%A0-%EA%B2%83-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>테스트 할 것</h3>\n<ul>\n<li>\n<p>API 문서 만들기</p>\n<ul>\n<li>요청 본문 문서화</li>\n<li>응답 본문 문서화</li>\n<li>\n<p>링크 문서화</p>\n<ul>\n<li>self</li>\n<li>query-events</li>\n<li>update-event</li>\n<li>profile 링크 추가</li>\n</ul>\n</li>\n<li>요청 헤더 문서화</li>\n<li>요청 필드 문서화</li>\n<li>응답 헤더 문서화</li>\n<li>응답 필드 문서화</li>\n</ul>\n</li>\n</ul>\n<br/>\n<h2 id=\"postgresql-적용\"><a href=\"#postgresql-%EC%A0%81%EC%9A%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>PostgreSQL 적용</h2>\n<p>테스트 할 때는 계속 H2를 사용해도 좋지만 애플리케이션 서버를 실행할 때 PostgreSQL을 사용하도록 변경하자.</p>\n<p>/scripts.md 참고</p>\n<ol>\n<li>PostgreSQL 드라이버 의존성 추가</li>\n</ol>\n<pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.postgresql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>postgresql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></code></pre>\n<ol start=\"2\">\n<li>도커로 PostgreSQL 컨테이너 실행</li>\n</ol>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run --name ndb -p <span class=\"token number\">5432</span>:5432 -e <span class=\"token assign-left variable\">POSTGRES_PASSWORD</span><span class=\"token operator\">=</span>pass -d postgres</code></pre>\n<ol start=\"3\">\n<li>도커 컨테이너에 들어가보기</li>\n</ol>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -i -t ndb <span class=\"token function\">bash</span>\n<span class=\"token function\">su</span> - postgres\npsql -d postgres -U postgres\n<span class=\"token punctuation\">\\</span>l\n<span class=\"token punctuation\">\\</span>dt</code></pre>\n<ol start=\"4\">\n<li>데이터소스 설정</li>\n</ol>\n<pre class=\"language-xml\"><code class=\"language-xml\">application.properties\nspring.datasource.username=postgres\nspring.datasource.password=pass\nspring.datasource.url=jdbc:postgresql://localhost:5432/postgres\nspring.datasource.driver-class-name=org.postgresql.Driver</code></pre>\n<ol start=\"5\">\n<li>하이버네이트 설정</li>\n</ol>\n<p><strong>application.properties</strong></p>\n<pre class=\"language-xml\"><code class=\"language-xml\">spring.jpa.hibernate.ddl-auto=create-drop\nspring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true\nspring.jpa.properties.hibernate.format_sql=true\nlogging.level.org.hibernate.SQL=DEBUG\nlogging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE</code></pre>\n<h3 id=\"애플리케이션-설정과-테스트-설정-중복-어떻게-줄일-것인가\"><a href=\"#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%84%A4%EC%A0%95-%EC%A4%91%EB%B3%B5-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A4%84%EC%9D%BC-%EA%B2%83%EC%9D%B8%EA%B0%80\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애플리케이션 설정과 테스트 설정 중복 어떻게 줄일 것인가?</h3>\n<ul>\n<li>프로파일과 @ActiveProfiles 활용</li>\n</ul>\n<p><strong>application-test.properties</strong></p>\n<pre class=\"language-xml\"><code class=\"language-xml\">spring.datasource.username=sa\nspring.datasource.password=\nspring.datasource.url=jdbc:h2:mem:testdb\nspring.datasource.driver-class-name=org.h2.Driver\n\nspring.datasource.hikari.jdbc-url=jdbc:h2:mem:testdb\n\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect</code></pre>\n<br/>\n<h2 id=\"인덱스-핸들러-만들기\"><a href=\"#%EC%9D%B8%EB%8D%B1%EC%8A%A4-%ED%95%B8%EB%93%A4%EB%9F%AC-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>인덱스 핸들러 만들기</h2>\n<h3 id=\"인덱스-핸들러\"><a href=\"#%EC%9D%B8%EB%8D%B1%EC%8A%A4-%ED%95%B8%EB%93%A4%EB%9F%AC\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>인덱스 핸들러</h3>\n<ul>\n<li>다른 리소스에 대한 링크 제공</li>\n<li>문서화</li>\n</ul>\n<pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResourceSupport</span> <span class=\"token function\">root</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ResourceSupport</span> index <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResourceSupport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        index<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">linkTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EventController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withRel</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"events\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> index<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre>\n<h3 id=\"테스트-컨트롤러-리팩토링\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>테스트 컨트롤러 리팩토링</h3>\n<ul>\n<li>중복 코드 제거</li>\n</ul>\n<h3 id=\"에러-리소스\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%A6%AC%EC%86%8C%EC%8A%A4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>에러 리소스</h3>\n<ul>\n<li>인덱스로 가는 링크 제공</li>\n</ul>\n","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/SpringLogo.214a68b.be0c3d9590430504675b948223711f21.png","size":{"width":820,"height":442},"sizes":"(max-width: 820px) 100vw, 820px","srcset":["/assets/static/SpringLogo.a67b0b2.be0c3d9590430504675b948223711f21.png 480w","/assets/static/SpringLogo.214a68b.be0c3d9590430504675b948223711f21.png 820w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 820 442' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-29f2605aef896f90944d207b9d4e9d4c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-29f2605aef896f90944d207b9d4e9d4c)' width='820' height='442' xlink:href='data:image/png%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAiAEADASIAAhEBAxEB/8QAGwABAAMBAAMAAAAAAAAAAAAAAAQFBgMCBwj/xAAqEAABAwQBAgUEAwAAAAAAAAABAgMEAAURIRIGMRNBUWGBFBUiMgdxof/EABgBAQADAQAAAAAAAAAAAAAAAAACAwQB/8QAIxEAAgICAgIBBQAAAAAAAAAAAAECEQMhEjEEQVEiYZGx4f/aAAwDAQACEQMRAD8A%2bnaUpQCs51b1SxYEobS348xwckt5wEj1Ua0dYx2BBX/IEt%2b9lrwRGQ7HD5AQcYB76OPT3rN5U5xglj026v4Ksrkl9Psr7H17OnXFqO5bUPpcVjEbPJPvvR/yvYDKy42FKTxVsFOc4I0RUWNLiuZFrZQhgDLkkN8G0pHocDkf60PWu8RYdbU6j9HFqWj3STo/Pf5rnjKcVU58hiUlpys7UpStRaKgXi5t2xplS21uuPuBpptBAKlEZ7kgDt51PqtvsF6fFS019ItPLK2pTXNCx8HII9RUMnLi%2bPZGV1oiOdRcJLMUWueZjrRdSxxSDpWDk5wB557VW3i%2b225Qm4cmBOedfWtox2xxdQ4jB4nfuDntquMKx3W3XmMIbyCW4jmVuNqUz%2bTmfCG8gAdt51VjbunXo90jXCRKQ7IDjzr5CMBSlpCQE%2bgAFYrz5Fxa%2bzuutfn2UXkkqKCNHs0e4JaMS7T5AeW0mO66Fp5oSFdsgY3561WjR1RHcaaSxDluTXHVsiGEgOJUj9snOABkbrxidPusX77gZCCj6h57gEnOFpSAPjFV1ytUy1z/ALjBDj0lUp50eGyXEhtYT%2bK0gg%2bXcVGMcuFNxVK/hda3%2bziU4LSNDaLu3c3pbSWH2HYqkpcS8ACCRnGjVlWd6Rjzg9c51yQpDkt1JSlaOBwlOM8cnA9Ad6rRVtwSlKCcu/7ovxtuNsUpSrSYpSlAKUpQClKUB//Z' /%3e%3c/svg%3e"}}},"context":{}}